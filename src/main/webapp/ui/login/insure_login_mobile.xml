<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ev="http://www.w3.org/2001/xml-events"
    xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
    <head>
    	<w2:type>COMPONENT</w2:type>
    	<w2:buildDate />
    	<w2:MSA />
    	<xf:model>
    		<w2:dataCollection baseNode="map">
    			<w2:dataMap baseNode="map" id="dma_login_request">
    				<w2:keyInfo>
    					<w2:key dataType="text" name="아이디" id="userId"></w2:key>
    					<w2:key dataType="text" name="비밀번호" id="pw"></w2:key>
    					<w2:key dataType="text" name="로그인 타입" id="loginType"></w2:key>
    				</w2:keyInfo>
    			</w2:dataMap>
    			<w2:dataMap baseNode="map" id="dma_login_response">
    				<w2:keyInfo>
    					<w2:key dataType="text" name="아이디" id="id"></w2:key>
    					<w2:key dataType="text" name="사용자아이디" id="userId"></w2:key>
    				</w2:keyInfo>
    			</w2:dataMap>
    		</w2:dataCollection>
    		<w2:workflowCollection />
    		<xf:submission id="sbm_UserLogin" action="/InsWebApp/UserLogin.pwkjson" method="post" mediatype="application/json" ref='data:json,[{"id":"dma_login_request","key":"elData"},{"id":"dma_login_response","key":"elData"}]' target='' encoding="UTF-8"
    			instance="" replace="" errorHandler="scwin.sbm_UserLogin_submiterror" customHandler="" mode="asynchronous" processMsg="false" ev:submit="" ev:submitdone="scwin.sbm_UserLogin_submitdone"
    			ev:submiterror="" abortTrigger="">
    		</xf:submission>
    	</xf:model>
    	<w2:layoutInfo />
    	<w2:publicInfo method="" />
    	<script lazy="false" type="text/javascript"><![CDATA[scwin.onpageload = function() {
    
};

scwin.sbm_UserLogin_submitdone = function (e) {
    var customerId = null;
    var userIdString = null;
    
    try {
       
        if (e && e.responseJSON && e.responseJSON.dma_login_response) {
                    
                    customerId = e.responseJSON.dma_login_response.id;
                    userIdString = e.responseJSON.dma_login_response.userId; 
                }
        
        if (customerId && userIdString) {
            localStorage.setItem("id", customerId);
            localStorage.setItem("userId", userIdString);

            location.href = "/InsWebApp/websquare/websquare.html?w2xPath=/InsWebApp/ui/login/simple_pw.xml&userId=" + customerId;
        
        } else {
            alert("사용자 정보를 받아오는 데 실패했습니다. 관리자에게 문의하세요.");
            return;
        }
        
    } catch (error) {
        alert("로그인 처리 중 오류가 발생했습니다.");
        return;
    }
    
    //location.href = "/InsWebApp/websquare/websquare.html?w2xPath=/InsWebApp/main/mainWrapper.xml";
};

scwin.login_btn_onclick = function (e) {
    dma_login_request.set("loginType", "USER");
    var reqData = {"elData":dma_login_request.getJSON()};
    $c.sbm.execute(sbm_UserLogin, reqData);
};]]></script>
    	<w2:require as="udc_notification" type="page" variableClone="" src="/InsWebApp/cm/udc/matrix/notification.xml"></w2:require>
    </head>
    <body ev:onpageload="scwin.onpageload">
    	<xf:group class="sub_contents" id="" meta_snippetCategory="00_화면시작" meta_snippetKeyComponent="true" meta_snippetName="0_01 페이지시작"
    		style="">
    		<xf:group class="pgtbox" id="" meta_snippetCategory="02_타이틀" meta_snippetKeyComponent="true" meta_snippetName="2_01 페이지타이틀"
    			style="border-bottom:;border-bottom-style:solid;border-bottom-color:#BFBFBF;color:#578FCA;border-bottom-width:0em;width:100%;">
    			<xf:image src="/InsWebApp/images/ws5/logo/insureLogo.png" style="width:131px;height:50px;" id=""></xf:image>
    			<xf:group class="breadcrumb" id="" style="">
    				<xf:group id="" style="" tagname="ul">
    					<xf:group id="" style="" tagname="li"></xf:group>
    				</xf:group>
    			</xf:group>
    			<w2:udc_notification style="width: 30px;height: 30px;" title="" message=""></w2:udc_notification>
    			<w2:button style="width: 80px;height: 23px;border-color:#FFFFFF;background-color:#FFFFFF;" id="" class="" label="로그아웃"></w2:button>
    		</xf:group>
    	</xf:group>
    	<xf:group class="sub_contents" id="" meta_snippetCategory="00_화면시작" meta_snippetKeyComponent="true" meta_snippetName="0_01 페이지시작"
    		style="display: flex;  justify-content: center;  align-items: center;">


    		<xf:image id="" src="/InsWebApp/images/ws5/logo/insureLogo.png" style="width:131px;height:50px;"></xf:image>
    	</xf:group>
    	<xf:group class="tblbox" id="" meta_snippetCategory="05_입출력테이블" meta_snippetKeyComponent="true" meta_snippetName="5_01 1단테이블"
    		style="">
    		<xf:group adaptive="layout" adaptiveThreshold="768" class="w2tb tbl" id="" style="" tagname="table">
    			<w2:attributes>
    				<w2:summary></w2:summary>
    			</w2:attributes>
    			<xf:group tagname="colgroup">
    				<xf:group style="" tagname="col"></xf:group>
    			</xf:group>
    			<xf:group style="" tagname="tr">
    				<xf:group class="w2tb_td" style=";text-align:center;" tagname="td">
    					<w2:span id="" label="아이디" meta_snippetCategory="10_입력폼" meta_snippetKeyComponent="true"
    						meta_snippetName="10_16 출력텍스트" style="">
    					</w2:span>

    					<xf:input id="" style="width:144px; height:21px; " ref="data:dma_login_request.userId"></xf:input>
    				</xf:group>
    			</xf:group>
    			<xf:group tagname="tr">
    				<xf:group tagname="td" class="w2tb_td" style=";text-align:center;">
    					<w2:attributes></w2:attributes>
    					<w2:span id="" label="비밀번호" meta_snippetCategory="10_입력폼" meta_snippetKeyComponent="true"
    						meta_snippetName="10_16 출력텍스트" style="">
    					</w2:span>
    					<xf:secret id="" style="width:144px; height:21px; " ref="data:dma_login_request.pw"></xf:secret>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    	</xf:group>
    <xf:group id="" style="display: flex;justify-content: right;  align-items: right;"><w2:button style="width:80px; height:23px; " id="login_btn" label="로그인" ev:onclick="scwin.login_btn_onclick"></w2:button></xf:group></body>
</html>
